{"version":3,"sources":["../../src/pages/chat/chat.page.module.ts","../../src/pipes/pipe.module.ts","../../src/pipes/platform.pipe.ts","../../src/pages/chat/chat.page.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular/module';\n\nimport { PipeModule } from '../../pipes/pipe.module';\nimport { ChatPage } from './chat.page';\n\n@NgModule({\n    declarations: [ChatPage],\n    imports: [IonicPageModule.forChild(ChatPage), PipeModule]\n})\nexport class ChatPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chat.page.module.ts","import { NgModule } from '@angular/core';\n\nimport { PlatformPipe } from './platform.pipe';\n\n@NgModule({\n    imports: [],\n    declarations: [PlatformPipe],\n    exports: [PlatformPipe]\n})\nexport class PipeModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/pipe.module.ts","import { Pipe, PipeTransform } from '@angular/core';\nimport { Platform } from 'ionic-angular';\n\n@Pipe({ name: 'platform' })\nexport class PlatformPipe implements PipeTransform {\n    constructor(private platform: Platform) {\n        (window as any).platform = platform;\n    }\n\n    public transform(value: any, platforms = ''): any {\n        const support = platforms\n            .split(',')\n            .map(p => {\n                switch (p) {\n                    case 'md':\n                        return 'android';\n                    case 'wp':\n                        return 'windows';\n                    default:\n                        return p;\n                }\n            })\n            .filter(p => !!p);\n\n        return support.some(p => this.platform.is(p)) ? value : undefined;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/platform.pipe.ts","import {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    OnDestroy,\n    OnInit,\n    Renderer,\n    ViewChild\n} from '@angular/core';\nimport { Keyboard } from '@ionic-native/keyboard';\nimport {\n    Content,\n    Header,\n    IonicPage,\n    NavParams,\n    Platform,\n    TextInput\n} from 'ionic-angular';\nimport { Observable } from 'rxjs/Observable';\nimport { Subscription } from 'rxjs/Subscription';\n\nimport { Chat, ChatEntry, ChatType } from '../../models/chat';\nimport { ConversationService } from '../../services/conversation.service';\nimport { StoreService } from '../../services/store.service';\n\n@IonicPage()\n@Component({\n    selector: 'page-chat',\n    templateUrl: 'chat.html',\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ChatPage implements OnInit, OnDestroy {\n    @ViewChild(Header) public headerField: Header;\n    @ViewChild(Content) public contentField: Content;\n    @ViewChild('input') public inputField: TextInput;\n    public chat: Observable<Chat>;\n\n    private subscriptions: Subscription[] = [];\n\n    constructor(\n        private cd: ChangeDetectorRef,\n        private renderer: Renderer,\n        private platform: Platform,\n        private navParams: NavParams,\n        private keyboard: Keyboard,\n        private store: StoreService,\n        private conversation: ConversationService\n    ) {}\n\n    public ngOnInit(): void {\n        this.chat = this.store.select(state => state.chat);\n        this.subscriptions = [\n            this.keyboard.onKeyboardShow().subscribe(this.onKeyboardShow),\n            this.keyboard.onKeyboardHide().subscribe(this.onKeyboardHide)\n        ];\n\n        if (this.store.getState().chat.length === 0) {\n            this.conversation.message().subscribe(entry => {\n                this.store.dispatch('CHAT_APPEND', entry);\n                this.cd.detectChanges();\n                this.contentField.scrollToBottom(400);\n            });\n        }\n    }\n\n    public ngOnDestroy(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n\n    public ionViewWillEnter(): void {\n        // For some reason a timeout is required to completely scroll to the\n        // bottom of the chat.\n        setTimeout(() => this.contentField.scrollToBottom(0), 0);\n    }\n\n    public sendAttachment(): void {}\n    public sendAudio(): void {}\n\n    public sendText(text: string): void {\n        text = text.trim();\n\n        if (text) {\n            const newEntry: ChatEntry = {\n                timestamp: new Date(),\n                type: ChatType.Text,\n                text\n            };\n            this.store.dispatch('CHAT_APPEND', newEntry);\n\n            this.conversation.message(newEntry).subscribe(response => {\n                this.store.dispatch('CHAT_APPEND', response);\n                this.cd.detectChanges();\n                this.contentField.scrollToBottom(400);\n            });\n        }\n\n        this.inputField.value = '';\n        this.inputField.setFocus();\n        this.cd.detectChanges();\n        this.contentField.scrollToBottom(400);\n    }\n\n    private onKeyboardShow = (event: any): void => {\n        if (this.platform.is('ios')) {\n            const keyboardHeight = event.keyboardHeight;\n            const header = this.headerField.getNativeElement();\n            const content = this.contentField.getNativeElement();\n\n            this.renderer.setElementStyle(header, 'top', keyboardHeight + 'px');\n            this.renderer.setElementStyle(content, 'marginTop', keyboardHeight);\n\n            this.cd.detectChanges();\n        }\n\n        // For some reason a timeout is required to completely scroll to the\n        // bottom of the chat.\n        setTimeout(() => this.contentField.scrollToBottom(100), 200);\n    };\n\n    private onKeyboardHide = (): void => {\n        if (this.platform.is('ios')) {\n            const content = this.contentField.getNativeElement();\n            const header = this.headerField.getNativeElement();\n\n            this.renderer.setElementStyle(content, 'marginTop', '0px');\n            this.renderer.setElementStyle(header, 'top', '0');\n\n            this.cd.detectChanges();\n        }\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chat.page.ts"],"sourceRoot":""}